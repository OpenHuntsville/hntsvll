<link rel="stylesheet" type="text/css" href="/css/datetimepicker/jquery.datetimepicker.css"/>

<form data-scope="events" id="people-form" data-prop="action">
  <ul class="errors"><li data-scope="error"></li></ul>
  <fieldset class="margin-t">
    <ul>
    <input type="hidden" data-prop="id" />
      <li>
        <label>Event Name</label>
        <input type="text" data-prop="name" name="events[name]" placeholder="Name" required>
      </li>
      <li>
        <label>Description</label>
        <textarea data-prop="description" id="bio" name="events[description]" placeholder="Enter your event description (160 characters or less)"></textarea>
        <p class="smalltext">You have <span id="bio-character-count"></span> characters left.</p>
      </li>
      <li style="width:100%;">
        <label>Group</label>
        <select type="text" data-prop="parent_group" class="chosen" required></select>
      </li>
      <li>
        <label>Start DateTime</label>
        <input type="text" data-prop="start_datetime" id="datetimepicker"/>
      </li>
      <li style="width:100%;">
        <label>Venue</label>
        <select type="text" data-prop="venue" class="chosen" required></select>
      </li>
    </ul>
    <input id="submit" type="submit" value="Save">
  </fieldset>
</form>
<script src="/js/datetimepicker/jquery.datetimepicker.full.js"></script>
<script>
$("form").submit(function(e) {

    var ref = $(this).find("[required]");

    $(ref).each(function(){
        if ( $(this).val() == '' )
        {
            alert("Required field should not be blank.");

            $(this).focus();

            e.preventDefault();
            return false;
        }
    });  return true;
});

$.datetimepicker.setLocale('en');

var months = ["Jan", "Feb", "Mar", "Apr", "May", "June",
                          "July", "Aug", "Sept", "Oct", "Nov", "Dec"];
var daysOfWeek = ["Sun", "Mon", "Tues", "Wed", "Thurs", "Fri", "Sat"];

/*
var nextWednesday = new Date();
nextWednesday.setDate(nextWednesday.getDate() + (3 - 1 - nextWednesday.getDay() + 7) % 7 + 1);
var defaultValue = months[nextWednesday.getMonth()] + " "
                    + nextWednesday.getDate().toString() + ", "
                    + nextWednesday.getFullYear().toString() + " "
                    + "18:00 PM";
*/
var nextWednesday = getnextWednesday();
var defaultValue = nextWednesday.month + " " + nextWednesday.day + ", " + nextWednesday.year + " " + "18:00 PM";
$('#datetimepicker').datetimepicker({
	disabledWeekDays: [0,1,2,4,5,6],
	allowTimes:['18:00','19:00','20:00','21:00'],
  formatTime:'g:i A',
  format: 'M j, Y g:i A',
  inline:true,
  defaultDate: nextWednesday,
  minDate: nextWednesday,
  defaultTime: "18:00",
  value: defaultValue
});

/**
 * Gets the date of the next Wednesday. If today is Wednesday,
 * the result will then be the Wednesday of the following week.
 * @see http://stackoverflow.com/questions/3638906/get-date-of-specific-day-of-the-week-in-javascript
 * @param {Date} date Today's date
 * @returns {Date} Returns the date of the next Wednesday.
 */
function getnextWednesday(date) {
    var nextWed = new Date(date || new Date());
    nextWed.setDate(nextWed.getDate() + (3 - 1 - nextWed.getDay() + 7) % 7 + 1);

    return {
      month: nextWed.getMonth(),
      day: nextWed.getDate().toString(),
      year: nextWed.getFullYear().toString(),
      dayOfWeek: nextWed.getDay()
    };
}
</script>
